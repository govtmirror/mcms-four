<!--
@license
Copyright (c) 2015 dean wagner wagner@nmb.gov. All rights reserved.
-->

<dom-module id="mcms-activitylist">

  <style>
    :host {
      display: block;
      box-sizing: border-box;
      background-color: gray;
      color: white;
    }
  </style>

  <template>
    <h3>{{selectedCase.caseID}}</h3>
    <template is="dom-repeat" 
        items="{{selectedActivities}}"
        filter="_hasCase"
        id="actlist">

      <mcms-activity activity="{{item}}">
      </mcms-activity>



    </template>
  </template>

  <script>

    Polymer({

      is: 'mcms-activitylist',

      properties: {
        selectedActivities: Array,
        selectedCase: {
          type: Object,
          value: function () {
            return {};
          }
        }
      },

      redrawit: function () {
        this.$.actlist.render();
      },

      _hasCase: function (item) {
        // console.log("in _hasCase");
        var teststring = this.selectedCase.caseID;
        // console.log("in _hasCase, " + teststring);
        if (teststring) {
          var testresult = false;
          var testObject = item.cases;
          for (var prop in testObject) {
            if (!testObject.hasOwnProperty(prop)) {
              //The current property is not a direct property of p
              continue;
            }

            // console.log(prop + ", " + teststring);

            if (testObject[prop].startsWith(teststring)) {
              testresult = true;
            }
          }
          return testresult;
        } else {
          return false;
          // console.log("no teststring");
        }  
        // return true;
      }

    });

  </script>
</dom-module>